services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile.frontend
    ports:
      - "5173:5173"
    environment:
      - VITE_REGISTRY_HTTP_URL=${VITE_REGISTRY_HTTP_URL:-http://localhost:8780}
    depends_on:
      - agent-registry

  agent-registry:
    build:
      context: .
      dockerfile: agent-registry/Dockerfile
    ports:
      - "8780:8780"
    environment:
      - FLEX_DB_PATH=/data/flex.db
      - FLEX_ADMIN_PASSWORD=${FLEX_ADMIN_PASSWORD:-}
    volumes:
      - flex-registry-data:/data

volumes:
  flex-registry-data:
